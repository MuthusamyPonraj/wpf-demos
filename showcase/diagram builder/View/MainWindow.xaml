<syncfusion:RibbonWindow x:Class="syncfusion.diagrambuilder.wpf.DiagramBuilderDemo"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:utility="clr-namespace:DiagramBuilder.Utility"
        xmlns:viewModel="clr-namespace:DiagramBuilder.ViewModel"
        xmlns:System="clr-namespace:System;assembly=mscorlib"
        xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
        xmlns:view="clr-namespace:DiagramBuilder.View"
                         xmlns:local="clr-namespace:syncfusion.diagrambuilder.wpf"
                         Office2010Icon="/syncfusion.diagrambuilder.wpf;component/Resources/syncfusion.png"
       IsGlassActive="False"
                         
        x:Name="diagrambuilder" UseLayoutRounding="True" SnapsToDevicePixels="True"
        Title="Diagram Builder"  WindowStartupLocation="CenterScreen"
                         xmlns:brainstorming="clr-namespace:Brainstorming.ViewModel"
                         xmlns:brainstormingUtility="clr-namespace:Brainstorming.Utility"
                         xmlns:brainstormingView="clr-namespace:Brainstorming.View"
                         WindowState="Maximized"
                         >
    <Window.Resources>
        <ResourceDictionary>
            
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Syncfusion.SfDiagram.Wpf;component/Resources/BindingStyle.xaml" />
                <ResourceDictionary Source="/Syncfusion.SfDiagram.Wpf;component/Resources/BasicShapes.xaml" />
                <ResourceDictionary Source="/syncfusion.diagrambuilder.wpf;component/Theme/DiagramBuilderUI.xaml" />
                <ResourceDictionary Source="/syncfusion.diagrambuilder.wpf;component/Brainstorming/Theme/BrainstormingUI.xaml" />
                <ResourceDictionary Source="/syncfusion.diagrambuilder.wpf;component/OrganizationChart/Theme/OrganizationChartUI.xaml"/>
                <ResourceDictionary Source="/syncfusion.diagrambuilder.wpf;component/FlowChart/Theme/FlowChartUI.xaml" />
            </ResourceDictionary.MergedDictionaries>
            
            <DataTemplate x:Key="ribbonVariantItemTemplate">
                <Grid>
                    <Path Data="M0.5,0.5L25.5,0.5L25.5,25.557L0.5,25.557z" Stretch="Fill" Width="42" Height="42" 
                      Fill="{Binding [0].Fill}" 
                      Stroke="{Binding [0].Stroke}" 
                      StrokeThickness="{Binding [0].StrokeThickness}" StrokeDashArray="{Binding [0].StrokeDashArray}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="5,4,0,0"/>
                    <Path Data="M0.5,0.5L25.5,0.5L25.5,25.557L0.5,25.557z" Stretch="Fill" Width="20" Height="20" 
                      Fill="{Binding [3].Fill}" 
                      Stroke="{Binding [3].Stroke}" 
                      StrokeThickness="{Binding [3].StrokeThickness}" StrokeDashArray="{Binding [3].StrokeDashArray}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="38,22,0,0"/>
                    <Path Data="M0.5,0.5L25.5,0.5L25.5,25.557L0.5,25.557z" Stretch="Fill" Width="20" Height="20" 
                      Fill="{Binding [1].Fill}" 
                      Stroke="{Binding [1].Stroke}" 
                      StrokeThickness="{Binding [1].StrokeThickness}" StrokeDashArray="{Binding [1].StrokeDashArray}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="32,15,0,0"/>
                    <Path Data="M0.5,0.5L25.5,0.5L25.5,25.557L0.5,25.557z" Stretch="Fill" Width="20" Height="20" 
                      Fill="{Binding [2].Fill}" 
                      Stroke="{Binding [2].Stroke}" 
                      StrokeThickness="{Binding [2].StrokeThickness}" StrokeDashArray="{Binding [2].StrokeDashArray}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="24,7,0,0"/>

                </Grid>
            </DataTemplate>            
            <Style TargetType="syncfusion:Node" BasedOn="{StaticResource NodeBindingStyle}" />
            <Style TargetType="syncfusion:Connector" BasedOn="{StaticResource ConnectorBindingStyle}" />
            <Style TargetType="syncfusion:AnnotationEditor" BasedOn="{StaticResource AnnotationEditorBindingStyle}" />
        </ResourceDictionary>
    </Window.Resources>
    <Window.DataContext>
        <brainstorming:BrainstormingBuilderVM />
    </Window.DataContext>
    <Grid Background="Transparent" UseLayoutRounding="True" SnapsToDevicePixels="True">
        <Grid.Resources>
            <BitmapImage x:Key="newpagepng" UriSource="/syncfusion.diagrambuilder.wpf;component/Resources/New-page.png" />
            <BitmapImage x:Key="brainstorming" UriSource="/syncfusion.diagrambuilder.wpf;component/Resources/Brainstorming.png" />
            <BitmapImage x:Key="flowchart" UriSource="/syncfusion.diagrambuilder.wpf;component/Resources/Flow_diagram.png" />
            <BitmapImage x:Key="blank" UriSource="/syncfusion.diagrambuilder.wpf;component/Resources/BlankDiagram.png" />
            <BitmapImage x:Key="organizationchart" UriSource="/syncfusion.diagrambuilder.wpf;component/Resources/OrganizationChart.png"/>
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" VerticalAlignment="Top" UseLayoutRounding="True" SnapsToDevicePixels="True">
            <Grid.Resources>
                <Style x:Key="ribbonstyle" TargetType="syncfusion:Ribbon" BasedOn="{StaticResource Office2013RibbonStyle}" />
                <utility:BooleanToVisibility x:Key="BooleanToVisibility"/>
            </Grid.Resources>
            <syncfusion:Ribbon EnableMoreCommands="False" Style="{StaticResource ribbonstyle}" UseLayoutRounding="True" SnapsToDevicePixels="True" TextOptions.TextRenderingMode="ClearType" 
                                 TextOptions.TextFormattingMode="Display" utility:RibbonCommand.Command="{Binding DataContext.RibbonCommand ,ElementName=diagrambuilder}"   x:Name="ribbon" BackStageHeader="File" ItemsSource="{Binding DataContext.DiagramCommandsVm.DiagramTabs,ElementName=diagrambuilder}"
                               SelectedIndex="2" SelectionChanged="Ribbon_SelectionChanged" 
                               >
                <syncfusion:Ribbon.ItemContainerStyle>
                    <Style TargetType="{x:Type syncfusion:RibbonTab}" >
                        <Setter Property="Caption" Value="{Binding Header}" />
                        <Setter Property="ItemsSource" Value="{Binding DiagramGroups}"/>
                        <Setter Property="IsChecked" Value="False" />
                        <Setter Property="ItemContainerStyle">
                            <Setter.Value>
                                <Style TargetType="{x:Type syncfusion:RibbonBar}"  BasedOn="{StaticResource Office2013RibbonBarStyle}">
                                    <Setter Property="Header" Value="{Binding Header}"/>
                                    <Setter Property="ItemsSource" Value="{Binding DiagramButtons}"/>
                                    <Setter Property="IsLauncherButtonVisible" Value="False"/>

                                    <Setter Property="ItemTemplateSelector" Value="{StaticResource DisplayControlSelector}" />
                                    <Style.Triggers>
                                        <Trigger Property="Header" Value="Clipboard">
                                            <Setter Property="ItemsPanel">
                                                <Setter.Value>
                                                    <ItemsPanelTemplate>
                                                        <view:CustomGrid Header="Clipboard" />
                                                    </ItemsPanelTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                        <Trigger Property="Header" Value="Font">
                                            <Setter Property="ItemsPanel">
                                                <Setter.Value>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel Width="230" />
                                                    </ItemsPanelTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                        <Trigger Property="Header" Value="Paragraph">
                                            <Setter Property="ItemsPanel">
                                                <Setter.Value>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel Width="80" />
                                                    </ItemsPanelTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                        <Trigger Property="Header" Value="ShapeStyle">
                                            <Setter Property="ItemsPanel">
                                                <Setter.Value>
                                                    <ItemsPanelTemplate>
                                                        <view:CustomGrid Header="ShapeStyle" />
                                                    </ItemsPanelTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                        <Trigger Property="Header" Value="Shapes">
                                            <Setter Property="IsLauncherButtonVisible" Value="True"/>
                                            <Setter Property="syncfusion:RibbonBar.LauncherCommand" Value="{Binding DataContext.SelectedDiagram.EditCommand, ElementName=diagrambuilder}"/>
                                        </Trigger>
                                        <Trigger Property="Header" Value="Themes">
                                            <Setter Property="ItemTemplate">
                                                <Setter.Value>
                                                    <DataTemplate>
                                                        <syncfusion:RibbonGallery VisualMode="InRibbon" 
                                                                                  IsEnabled="{Binding DataContext.IsOrgChartSelected, ElementName=diagrambuilder}"
                                                                                  ExpandHeight="450"  Width="550" ItemWidth="75" ItemHeight="55" Margin="0,5,5,0"
                                      SelectedItem="{Binding ElementName=Office_ThemeRibbon}" 
                                      utility:GallerySelection.SelectCommand="{Binding DataContext.QuickStyle,ElementName=diagrambuilder}">
                                                            <syncfusion:RibbonGallery.ItemTemplate>
                                                                <DataTemplate>
                                                                    <Grid>
                                                                        <Path Data="M0.5,0.5L25.5,0.5L25.5,25.557L0.5,25.557z" Stretch="Fill" Width="38" Height="38" 
                      Fill="{Binding Variant1.Fill}" 
                      Stroke="{Binding Variant1.Stroke}" 
                      StrokeThickness="{Binding Variant1.StrokeThickness}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="5,4,0,0"/>
                                                                        <Path Data="M0.5,0.5L25.5,0.5L25.5,25.557L0.5,25.557z" Stretch="Fill" Width="18" Height="18" 
                      Fill="{Binding Variant4.Fill}" 
                      Stroke="{Binding Variant4.Stroke}" 
                      StrokeThickness="{Binding Variant4.StrokeThickness}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="44,18,0,0"/>
                                                                        <Path Data="M0.5,0.5L25.5,0.5L25.5,25.557L0.5,25.557z" Stretch="Fill" Width="18" Height="18" 
                      Fill="{Binding Variant2.Fill}" 
                      Stroke="{Binding Variant2.Stroke}" 
                      StrokeThickness="{Binding Variant2.StrokeThickness}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="39,13,0,0"/>
                                                                        <Path Data="M0.5,0.5L25.5,0.5L25.5,25.557L0.5,25.557z" Stretch="Fill" Width="18" Height="18" 
                      Fill="{Binding Variant3.Fill}" 
                      Stroke="{Binding Variant3.Stroke}" 
                      StrokeThickness="{Binding Variant3.StrokeThickness}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="33,7,0,0"/>
                                                                        <TextBlock Text="Aa" FontSize="{Binding Variant1.FontSize}" FontFamily="{Binding ConnectorVariant.FontFamily}" Foreground="{Binding Variant1.Foreground}" Margin="8,20,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                                                                        <Path Data="M0,1L0,6.5L30,6.5L30,-1" Margin="24,40,0,0" Stroke="{Binding ConnectorVariant.Stroke}" 
                      StrokeThickness="0.75" 
                      HorizontalAlignment="Left" VerticalAlignment="Top"/>
                                                                        <Path Data="M81.1582,85.8677L111.1582,33.9067L141.1582,85.8677L81.1582,85.8677z" Width="3" Height="3" Margin="52,36,0,0" 
                      Fill="{Binding ConnectorVariant.Stroke}" Stroke="{Binding ConnectorVariant.Stroke}" 
                      Stretch="Fill"
                      HorizontalAlignment="Left" VerticalAlignment="Top"/>
                                                                    </Grid>
                                                                </DataTemplate>
                                                            </syncfusion:RibbonGallery.ItemTemplate>
                                                            <syncfusion:RibbonGallery.GalleryFilters>
                                                                <syncfusion:RibbonGalleryFilter Label="All"/>
                                                                <syncfusion:RibbonGalleryFilter Label="Professional"/>
                                                                <syncfusion:RibbonGalleryFilter Label="Modern"/>
                                                                <syncfusion:RibbonGalleryFilter Label="Trendy"/>
                                                                <syncfusion:RibbonGalleryFilter Label="Custom"/>
                                                            </syncfusion:RibbonGallery.GalleryFilters>
                                                            <syncfusion:RibbonGallery.GalleryGroups>
                                                                <syncfusion:RibbonGalleryGroup Label="Professional" syncfusion:RibbonGallery.FilterIndexes="0,1">
                                                                    <view:DesignRibbonGalleryItem x:Name ="Office_ThemeRibbon" ThemeName="Office_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.Theme>
                                                                            <syncfusion:OfficeTheme />
                                                                        </view:DesignRibbonGalleryItem.Theme>
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Office Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Linear_ThemeRibbon" ThemeName="Linear_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Linear Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Zephyr_ThemeRibbon" ThemeName="Zephyr_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Zephyr Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Integral_ThemeRibbon" ThemeName="Integral_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Integral Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Simple_ThemeRibbon" ThemeName="Zephyr_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Simple Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Whisp_ThemeRibbon" ThemeName="Whisp_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Whisp Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Daybreak_ThemeRibbon" ThemeName="Daybreak_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Daybreak Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Parallel_ThemeRibbon" ThemeName="Parallel_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Parallel Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Sequence_ThemeRibbon" ThemeName="Sequence_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Sequence Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Slice_ThemeRibbon" ThemeName="Slice_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Slice Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Ion_ThemeRibbon" ThemeName="Ion_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Ion Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                </syncfusion:RibbonGalleryGroup>
                                                                <syncfusion:RibbonGalleryGroup Label="Modern" syncfusion:RibbonGallery.FilterIndexes="0,2">
                                                                    <view:DesignRibbonGalleryItem x:Name ="Retrospect_ThemeRibbon" ThemeName="Retrospect_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Retrospect Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Bubble_ThemeRibbon" ThemeName="Bubble_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Bubble Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Clouds_ThemeRibbon" ThemeName="Clouds_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Clouds Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Gemstone_ThemeRibbon" ThemeName="Gemstone_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Gemstone Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                </syncfusion:RibbonGalleryGroup>
                                                                <syncfusion:RibbonGalleryGroup Label="Trendy" syncfusion:RibbonGallery.FilterIndexes="0,3">
                                                                    <view:DesignRibbonGalleryItem x:Name ="Facet_ThemeRibbon" ThemeName="Facet_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Facet Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Prominence_ThemeRibbon" ThemeName="Prominence_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Prominence Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Smoke_ThemeRibbon" ThemeName="Smoke_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Smoke Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Radiance_ThemeRibbon" ThemeName="Radiance_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Radiance Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                </syncfusion:RibbonGalleryGroup>
                                                                <syncfusion:RibbonGalleryGroup Label="Custom" syncfusion:RibbonGallery.FilterIndexes="0,4">
                                                                    <view:DesignRibbonGalleryItem x:Name ="Custom1_ThemeRibbon" ThemeName="Custom1_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Custom 1 Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                    <view:DesignRibbonGalleryItem x:Name ="Custom2_ThemeRibbon" ThemeName="Custom2_ThemeRibbon">
                                                                        <view:DesignRibbonGalleryItem.ToolTip>
                                                                            <syncfusion:ScreenTip Content="Custom 2 Theme"/>
                                                                        </view:DesignRibbonGalleryItem.ToolTip>
                                                                    </view:DesignRibbonGalleryItem>
                                                                </syncfusion:RibbonGalleryGroup>
                                                            </syncfusion:RibbonGallery.GalleryGroups>
                                                            <syncfusion:RibbonGallery.MenuItems>
                                                                <view:ThemeCheckBox x:Name="newItemThemeStyleDecision" IsChecked="True"  Content="Apply Themes to New Shapes" />
                                                            </syncfusion:RibbonGallery.MenuItems>
                                                        </syncfusion:RibbonGallery>
                                                    </DataTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                        <Trigger Property="Header" Value="Variants">
                                            <Setter Property="ItemTemplate">
                                                <Setter.Value>
                                                    <DataTemplate>
                                                        <syncfusion:RibbonGallery x:Name="VariantRibbonGallery" MaxWidth="350" VisualMode="InRibbon" ItemWidth="75" ItemHeight="55" Background="White" 
                                         utility:VariantSelection.SelectionCommand="{Binding DataContext.VariantStyle,ElementName=diagrambuilder}" SelectedItem="{Binding ElementName=VariantGallery0}"
                                             >
                                                            <view:DesignVariantRibbonGalleryItem x:Name ="VariantGallery0" Theme="{Binding DataContext.SelectedDiagram.Theme,ElementName=diagrambuilder}" ContentTemplate ="{ StaticResource ribbonVariantItemTemplate}"
                                                                                                 Content="{Binding DataContext.SelectedDiagram.Theme.VariantStyles[0],ElementName=diagrambuilder}"
                                                                                                 IsEnabled="{Binding DataContext.IsOrgChartSelected, ElementName=diagrambuilder}"
                                                                                                 ConnectorVariant="{Binding DataContext.SelectedDiagram.Theme.ConnectorVariantStyles[0],ElementName=diagrambuilder}"/>
                                                            <view:DesignVariantRibbonGalleryItem x:Name ="VariantGallery1" Theme="{Binding DataContext.SelectedDiagram.Theme,ElementName=diagrambuilder}" ContentTemplate ="{ StaticResource ribbonVariantItemTemplate}"
                                                                                                 IsEnabled="{Binding DataContext.IsOrgChartSelected, ElementName=diagrambuilder}"
                                                                                                 Content="{Binding DataContext.SelectedDiagram.Theme.VariantStyles[1],ElementName=diagrambuilder}"
                                                                                                 ConnectorVariant="{Binding DataContext.SelectedDiagram.Theme.ConnectorVariantStyles[1],ElementName=diagrambuilder}"/>
                                                            <view:DesignVariantRibbonGalleryItem x:Name ="VariantGallery2" Theme="{Binding DataContext.SelectedDiagram.Theme,ElementName=diagrambuilder}" ContentTemplate ="{ StaticResource ribbonVariantItemTemplate}"
                                                                                                 IsEnabled="{Binding DataContext.IsOrgChartSelected, ElementName=diagrambuilder}"
                                                                                                 Content="{Binding DataContext.SelectedDiagram.Theme.VariantStyles[2],ElementName=diagrambuilder}"
                                                                                                 ConnectorVariant="{Binding DataContext.SelectedDiagram.Theme.ConnectorVariantStyles[2],ElementName=diagrambuilder}"/>
                                                            <view:DesignVariantRibbonGalleryItem x:Name ="VariantGallery3" Theme="{Binding DataContext.SelectedDiagram.Theme,ElementName=diagrambuilder}" ContentTemplate ="{ StaticResource ribbonVariantItemTemplate}"
                                                                                                 IsEnabled="{Binding DataContext.IsOrgChartSelected, ElementName=diagrambuilder}"
                                                                                                 Content="{Binding DataContext.SelectedDiagram.Theme.VariantStyles[3],ElementName=diagrambuilder}"
                                                                                                 ConnectorVariant="{Binding DataContext.SelectedDiagram.Theme.ConnectorVariantStyles[3],ElementName=diagrambuilder}"/>
                                                        </syncfusion:RibbonGallery>
                                                    </DataTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                        <Trigger Property="Header" Value="Show">
                                            <Setter Property="ItemsPanel">
                                                <Setter.Value>
                                                    <ItemsPanelTemplate>
                                                        <view:CustomGrid Header="Show" />
                                                    </ItemsPanelTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="Caption" Value="BRAINSTORMING">
                                <Setter Property="IsChecked" Value="True"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </syncfusion:Ribbon.ItemContainerStyle>
                <syncfusion:Ribbon.QuickAccessToolBar>
                    <syncfusion:QuickAccessToolBar>
                        <syncfusion:QuickAccessToolBar.QATMenuItems>
                            <syncfusion:RibbonButton Label="Save" syncfusion:RibbonCommandManager.SynchronizedItem="Save" />
                            <syncfusion:RibbonButton Label="Load" syncfusion:RibbonCommandManager.SynchronizedItem="Load" />
                            <syncfusion:RibbonButton Label="Undo" syncfusion:RibbonCommandManager.SynchronizedItem="Undo" />
                            <syncfusion:RibbonButton Label="Redo" syncfusion:RibbonCommandManager.SynchronizedItem="Redo" />
                        </syncfusion:QuickAccessToolBar.QATMenuItems>

                        <syncfusion:RibbonButton Label="Save"
                                                 SizeForm="ExtraSmall"
                                                 SmallIcon="/syncfusion.diagrambuilder.wpf;component/Resources/Save.png"
                                                 Command="{Binding DataContext.Save ,ElementName=diagrambuilder}"
                                                 ToolTip="Save" 
                                                 syncfusion:RibbonCommandManager.SynchronizedItem="Save"
                                                 />
                        <syncfusion:RibbonButton Label="Open"
                                                 SizeForm="ExtraSmall"
                                                 SmallIcon="/syncfusion.diagrambuilder.wpf;component/Resources/Load.png"
                                                 Command="{Binding DataContext.Open ,ElementName=diagrambuilder}"
                                                 ToolTip="Open" 
                                                 syncfusion:RibbonCommandManager.SynchronizedItem="Load"
                                                 />
                        <syncfusion:RibbonButton Label="Undo"                                                 
                                                 SizeForm="ExtraSmall"
                                                 SmallIcon="/syncfusion.diagrambuilder.wpf;component/Resources/Undo.png"
                                                 Command="syncfusion:DiagramCommands.Undo"
                                                 ToolTip="Undo"
                                                 syncfusion:RibbonCommandManager.SynchronizedItem="Undo"
                                                 IsEnabled="{Binding DataContext.IsBlankDiagramSelected, Mode=TwoWay,ElementName=diagrambuilder}"
                                                 />
                        <syncfusion:RibbonButton Label="Redo"                                                 
                                                 SizeForm="ExtraSmall"
                                                 SmallIcon="/syncfusion.diagrambuilder.wpf;component/Resources/Redo.png"
                                                 Command="syncfusion:DiagramCommands.Redo"
                                                 ToolTip="Redo"
                                                 syncfusion:RibbonCommandManager.SynchronizedItem="Redo"
                                                 IsEnabled="{Binding DataContext.IsBlankDiagramSelected, Mode=TwoWay,ElementName=diagrambuilder}"
                                                 />
                    </syncfusion:QuickAccessToolBar>
                </syncfusion:Ribbon.QuickAccessToolBar>

                <!--  Back Stage  -->
                <syncfusion:Ribbon.BackStage>
                    <syncfusion:Backstage>
                        <syncfusion:BackstageTabItem Header="New" >
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="75"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Margin="20,0,0,0" Text="New" FontSize="25" Foreground="#111111" FontFamily="SegoeUI" HorizontalAlignment="Left"/>
                                <StackPanel Orientation="Horizontal" Grid.Row="1" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20,0,0,0">
                                    <Button Width="132" Height="155"
                                            Command="{Binding DataContext.New, Mode=TwoWay,ElementName=ribbon}" 
                                                 CommandParameter="Blank" Background="Transparent"
                                            >
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Grid x:Name="grid" Background="#FFFFFF">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="125"/>
                                                        <RowDefinition Height="30"/>
                                                    </Grid.RowDefinitions>
                                                    <Border x:Name="border" Width="120" Height="120"  BorderBrush="#B4B4B6" BorderThickness="1" HorizontalAlignment="Left" 
                                                            VerticalAlignment="Top" Margin="5,5,0,0">
                                                        <Image Source="{StaticResource blank}" Width="62" Height="62" Stretch="Fill"/>
                                                    </Border>
                                                    <TextBlock Text="Blank Diagram" Grid.Row="1" FontSize="10" Foreground="#111111" 
                                                               FontFamily="SegoeUI" FontWeight="SemiBold" VerticalAlignment="Center" HorizontalAlignment="Center" 
                                                               Margin="5,5,0,0"/>
                                                </Grid>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="Button.IsFocused" Value="True">
                                                        <Setter TargetName="grid" Property="Background" Value="#AAC2E7" />
                                                        <Setter TargetName="border" Property="Background" Value="#FFFFFF" />
                                                    </Trigger>
                                                    <Trigger Property="Button.IsMouseOver" Value="True">
                                                        <Setter TargetName="grid" Property="Background" Value="#D2DFF2" />
                                                        <Setter TargetName="border" Property="Background" Value="#FFFFFF" />
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                    <Button Width="132" Height="155" Margin="20,0,0,0"
                                            Command="{Binding DataContext.New, Mode=TwoWay,ElementName=ribbon}" 
                                                 CommandParameter="FlowChart" Background="Transparent"
                                            >
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Grid x:Name="grid" Background="#FFFFFF">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="125"/>
                                                        <RowDefinition Height="30"/>
                                                    </Grid.RowDefinitions>
                                                    <Border x:Name="border" Width="120" Height="120" BorderBrush="#B4B4B6" BorderThickness="1" HorizontalAlignment="Left" 
                                                            VerticalAlignment="Top" Margin="5,5,0,0">
                                                        <Image Source="{StaticResource flowchart}" Width="75" Height="75" Stretch="Fill"/>
                                                    </Border>
                                                    <TextBlock Text="Basic Flowchart" Grid.Row="1" FontSize="10" Foreground="#111111" FontFamily="SegoeUI" FontWeight="SemiBold"
                                                               VerticalAlignment="Center" HorizontalAlignment="Center" 
                                                               Margin="5,5,0,0"
                                                               />
                                                </Grid>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="Button.IsFocused" Value="True">
                                                        <Setter TargetName="grid" Property="Background" Value="#AAC2E7" />
                                                        <Setter TargetName="border" Property="Background" Value="#FFFFFF" />
                                                    </Trigger>
                                                    <Trigger Property="Button.IsMouseOver" Value="True">
                                                        <Setter TargetName="grid" Property="Background" Value="#D2DFF2" />
                                                        <Setter TargetName="border" Property="Background" Value="#FFFFFF" />
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                    <Button Width="132" Height="155" Margin="20,0,0,0"
                                            Command="{Binding DataContext.New, Mode=TwoWay,ElementName=ribbon}" 
                                                 CommandParameter="Brainstorming" Background="Transparent"
                                            >
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Grid x:Name="grid" Background="#FFFFFF">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="125"/>
                                                        <RowDefinition Height="30"/>
                                                    </Grid.RowDefinitions>
                                                    <Border x:Name="border" Width="120" Height="120" BorderBrush="#B4B4B6" BorderThickness="1" HorizontalAlignment="Left" 
                                                            VerticalAlignment="Top" Margin="5,5,0,0">
                                                        <Image Source="{StaticResource brainstorming}" Width="75" Height="75" Stretch="Fill"/>
                                                    </Border>
                                                    <TextBlock Text="Brainstorming Diagram" TextWrapping="WrapWithOverflow" Grid.Row="1" FontSize="10" Foreground="#111111" FontFamily="SegoeUI" FontWeight="SemiBold"
                                                               VerticalAlignment="Center" HorizontalAlignment="Center" 
                                                               Margin="5,5,0,0"
                                                               />
                                                </Grid>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="Button.IsFocused" Value="True">
                                                        <Setter TargetName="grid" Property="Background" Value="#AAC2E7" />
                                                        <Setter TargetName="border" Property="Background" Value="#FFFFFF" />
                                                    </Trigger>
                                                    <Trigger Property="Button.IsMouseOver" Value="True">
                                                        <Setter TargetName="grid" Property="Background" Value="#D2DFF2" />
                                                        <Setter TargetName="border" Property="Background" Value="#FFFFFF" />
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>

                                    <Button Width="132" Height="155" Margin="20,0,0,0"
                                            Command="{Binding DataContext.New, Mode=TwoWay,ElementName=ribbon}" 
                                            CommandParameter="OrganizationChart"
                                            Click="HideBackstage_Click" Background="Transparent">
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Grid x:Name="grid" Background="#FFFFFF">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="125"/>
                                                        <RowDefinition Height="30"/>
                                                    </Grid.RowDefinitions>
                                                    <Border x:Name="border" Width="120" Height="120" BorderBrush="#B4B4B6" BorderThickness="1" HorizontalAlignment="Left" 
                                                            VerticalAlignment="Top" Margin="5,5,0,0">
                                                        <Image Source="{StaticResource organizationchart}" Width="75" Height="75" Stretch="Fill"/>
                                                    </Border>
                                                    <TextBlock Text="Organization Chart" TextWrapping="WrapWithOverflow" Grid.Row="1" FontSize="10" Foreground="#111111" FontFamily="SegoeUI" FontWeight="SemiBold"
                                                               VerticalAlignment="Center" HorizontalAlignment="Center" 
                                                               Margin="5,5,0,0"/>
                                                </Grid>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="Button.IsFocused" Value="True">
                                                        <Setter TargetName="grid" Property="Background" Value="#AAC2E7" />
                                                        <Setter TargetName="border" Property="Background" Value="#FFFFFF" />
                                                    </Trigger>
                                                    <Trigger Property="Button.IsMouseOver" Value="True">
                                                        <Setter TargetName="grid" Property="Background" Value="#D2DFF2" />
                                                        <Setter TargetName="border" Property="Background" Value="#FFFFFF" />
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </syncfusion:BackstageTabItem>
                        <syncfusion:BackStageCommandButton Header="Open"  Command="{Binding DataContext.Open, Mode=TwoWay,ElementName=ribbon}" />
                        <syncfusion:BackStageCommandButton IsEnabled="False" Header="Save"  Command="{Binding DataContext.Save, Mode=TwoWay,ElementName=ribbon}" />
                        <syncfusion:BackStageCommandButton IsEnabled="False" Header="SaveAs" Command="{Binding DataContext.SaveAs, Mode=TwoWay,ElementName=ribbon}" />
                        <syncfusion:BackStageCommandButton IsEnabled="False" Header="Print"  Command="{Binding DataContext.SelectedDiagram.PrintCommand, Mode=TwoWay,ElementName=diagrambuilder}" />
                        <syncfusion:BackStageCommandButton IsEnabled="False" Header="Export" Command="{Binding DataContext.SelectedDiagram.ExportCommand, Mode=TwoWay,ElementName=diagrambuilder}" />
                        <syncfusion:BackStageCommandButton Header="Close" Click="CloseButtonClick" />
                    </syncfusion:Backstage>
                </syncfusion:Ribbon.BackStage>
            </syncfusion:Ribbon>
        </Grid>
        <view:DiagramBuilder1 Grid.Row="1" x:Name="Builder1"/>

    </Grid>
    <syncfusion:RibbonWindow.StatusBar>
        <syncfusion:RibbonStatusBar Grid.Row="2" Height="26">
            <Grid FocusManager.IsFocusScope="True" Focusable="True" Margin="0,0,10,0" HorizontalAlignment="Right" VerticalAlignment="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="20" />
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition Width="20" />
                    <ColumnDefinition Width="50" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <RepeatButton Grid.Column="2">
                    <RepeatButton.Style>
                        <Style TargetType="{x:Type RepeatButton}">
                            <Setter Property="Command" Value="{Binding ZoomIn}" />
                            <Setter Property="ToolTip" Value="ZoomIn"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                                        <Viewbox Width="13" Height="13">
                                            <Grid Background="Transparent">
                                                <Path Width="16"
                                                          Height="16"
                                                          Margin="0,0,0,0"
                                                          Data="M19.833,0L32.501,0 32.501,19.833999 52.334,19.833999 52.334,32.500999 32.501,32.500999 32.501,52.333 19.833,52.333 19.833,32.500999 0,32.500999 0,19.833999 19.833,19.833999z"
                                                          Fill="#FFFFFFFF"
                                                          RenderTransformOrigin="0.5,0.5"
                                                          Stretch="Uniform">
                                                    <Path.RenderTransform>
                                                        <TransformGroup>
                                                            <TransformGroup.Children>
                                                                <RotateTransform Angle="0" />
                                                                <ScaleTransform ScaleX="-1" ScaleY="-1" />
                                                            </TransformGroup.Children>
                                                        </TransformGroup>
                                                    </Path.RenderTransform>
                                                </Path>
                                            </Grid>
                                        </Viewbox>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Opacity" Value="0.5" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </RepeatButton.Style>
                </RepeatButton>
                <Slider  Grid.Column="1" IsMoveToPointEnabled="True"
                        Minimum="0.3"  Margin="5" Maximum="3" 
                        TickFrequency="0.1" 
                        Tag="FitToPage" 
                        Value="{Binding SelectedDiagram.SelectedItems.Scale, Mode=TwoWay}" ToolTip="Zoom">
                    <Slider.Style>
                        <Style TargetType="{x:Type Slider}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type Slider}">
                                        <Grid>
                                            <Border     Height="2"
                                                        VerticalAlignment="center"
                                                        Background="White"
                                                        BorderBrush="White"
                                                        BorderThickness="1"
                                                        CornerRadius="1">
                                                <Canvas >
                                                    <Rectangle x:Name="PART_SelectionRange"
                                                                   Height="2.0"                                                                  
                                                                   StrokeThickness="1.0"
                                                                   Visibility="Visible" />
                                                </Canvas>
                                            </Border>
                                            <Track x:Name="PART_Track" >
                                                <Track.Thumb>
                                                    <Thumb Foreground="White">
                                                        <Thumb.Style>
                                                            <Style TargetType="{x:Type Thumb}">
                                                                <Setter Property="Template">
                                                                    <Setter.Value>
                                                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                                                            <Rectangle Fill="{TemplateBinding Foreground}" Height="15" Width="3"/>
                                                                        </ControlTemplate>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </Style>
                                                        </Thumb.Style>
                                                    </Thumb>
                                                </Track.Thumb>
                                            </Track>
                                        </Grid>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Opacity" Value="0.5" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Slider.Style>
                </Slider>
                <RepeatButton x:Name="incrementButton" Grid.Column="0" >
                    <RepeatButton.Style>
                        <Style TargetType="{x:Type RepeatButton}">
                            <Setter Property="Command" Value="{Binding ZoomOut}" />
                            <Setter Property="ToolTip" Value="ZoomOut"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                                        <Viewbox Width="13" Height="13">
                                            <Grid Background="Transparent">
                                                <Path Width="16"
                                                          Height="16"
                                                          Margin="0,0,0,0"
                                                          Data="M0,0L53.333,0 53.333,8.888 0,8.888z"
                                                          Fill="#FFFFFFFF"
                                                          RenderTransformOrigin="0.5,0.5"
                                                          Stretch="Uniform">
                                                    <Path.RenderTransform>
                                                        <TransformGroup>
                                                            <TransformGroup.Children>
                                                                <RotateTransform Angle="0" />
                                                                <ScaleTransform ScaleX="-1" ScaleY="-1" />
                                                            </TransformGroup.Children>
                                                        </TransformGroup>
                                                    </Path.RenderTransform>
                                                </Path>
                                            </Grid>
                                        </Viewbox>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Opacity" Value="0.5" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </RepeatButton.Style>
                </RepeatButton>
                <TextBlock Margin="5" Foreground="White" ToolTip="Zoom level. Click to Open the Zoom Dialog Box." Text="{Binding SelectedDiagram.SelectedItems.Scale,Converter={StaticResource TexttoPercentageConverter}}" utility:RibbonCommand.Command="{Binding RibbonCommand,Mode=TwoWay}" Grid.Column="3" />

                <syncfusion:RibbonButton Tag="FitToPage" SizeForm="ExtraSmall" Grid.Column="4" 
                  Command="syncfusion:DiagramCommands.FitToPage" ToolTip="Fit page to current window"
                                         SmallIcon="/syncfusion.diagrambuilder.wpf;component/Resources/fullscreen-16x16-1.png">
                    <syncfusion:RibbonButton.CommandParameter>
                        <syncfusion:FitToPageParameter FitToPage="FitToPage" Margin="20" Region="PageSettings" />
                    </syncfusion:RibbonButton.CommandParameter>
                </syncfusion:RibbonButton>
            </Grid>
        </syncfusion:RibbonStatusBar>
    </syncfusion:RibbonWindow.StatusBar>


</syncfusion:RibbonWindow>
